<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:o="http://omnifaces.org/ui" xmlns:of="http://omnifaces.org/functions" template="/uii/template/template.html" xmlns:x="http://myfaces.apache.org/tomahawk" xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites">

    <ui:param name="myPageTitle" value="#{msgs.plugin}: #{msgs[('plugin_').concat(AktuelleSchritteForm.myPlugin.title)]}" />

    <ui:define name="breadcrumb">
        <intranda:breadcrumb label="#{msgs.startseite}" action="index" navId="a0" />
        <intranda:breadcrumb label="#{msgs.aktuelleSchritte}" action="#{AktuelleSchritteForm.paginator.returnToPreviousPage}" />
        <intranda:breadcrumb label="#{AktuelleSchritteForm.mySchritt.prozess.titel}" action="task_edit" />
        <intranda:breadcrumb label="#{myPageTitle}" noSeparator="#{true}" />
    </ui:define>

    <ui:define name="info">
    </ui:define>

    <ui:define name="content">

        <style>
/* Thumbnails */
.goobi-thumbnail {
    float: left;
    margin: 7px 7px 7px 7px;
    min-height: 200px;
    min-width: 200px;
}

.goobi-thumbnail a img {
    max-height: 175px;
}

.goobi-thumbnail .goobi-thumbnail-image {
    float: left;
    min-height: 100px;
    overflow: hidden;
}

.goobi-thumbnail .goobi-thumbnail-image a img {
    display: block;
    border: solid 1px;
    border-color: lightgrey;
}

.goobi-thumbnail .goobi-thumbnail-image a {
    display: inline-block;
}

.goobi-thumbnail a {
    display: block;
    width: 100%;
    text-align: center;
}

.goobi-thumbnail .goobi-thumbnail-caption {
    float: left;
    width: 100%;
    line-height: 20px;
    text-align: center;
}

.big-image-caption {
    text-align: center;
}

.div-image img {
    float: right;
    border: solid 1px;
    border-color: lightgrey;
}

.img-active {
    background-color: #368ee0;
    color: white;
}

.image-navigation{
	margin-bottom:5px;
}

#image-control-wrapper{
	margin-left:6px;
}

#mainImage {
	widht:100%;
}
</style>

		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/plugins/step/#{AktuelleSchritteForm.myPlugin.title}/javascript/openseadragon/openseadragon.min.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/plugins/step/#{AktuelleSchritteForm.myPlugin.title}/javascript/openseadragon/openseadragon-viewerinputhook.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/plugins/step/#{AktuelleSchritteForm.myPlugin.title}/javascript/viewImage.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/plugins/step/#{AktuelleSchritteForm.myPlugin.title}/javascript/viewImage.controls.js"></script>
		<script type="text/javascript"
			src="#{HelperForm.applicationWebsiteUrl}/uii/plugins/step/#{AktuelleSchritteForm.myPlugin.title}/javascript/viewImage.zoomSlider.js"></script>
			
        <h:form id="qaform">
            <div class="box box-color lightgrey box-bordered">
                <div class="box-title">
                    <h3>
                        <i class="fa fa-puzzle-piece" />
                        <h:outputText id="id9" value="#{msgs.details}" />
                    </h3>
                    <div class="actions">
                        <h:commandLink id="id10" action="#{NavigationForm.Reload}" styleClass="btn btn-mini">
                            <i class="fa fa-refresh" />
                        </h:commandLink>
                    </div>
                </div>

                <div class="box-content">
                    <h:panelGroup layout="block" rendered="#{AktuelleSchritteForm.myPlugin.sizeOfImageList gt 0}" styleClass="col-sm-7">

                        <div class="row">
                            <ui:include src="ImageQAPlugin_include_thumbnavigation.xhtml" />
                        </div>

                        <!-- Thumbnail list -->
                        <div class="row margin-top-most margin-bottom-most">
                            <ui:repeat var="image" value="#{AktuelleSchritteForm.myPlugin.paginatorList}">
                                <div class="goobi-thumbnail #{AktuelleSchritteForm.myPlugin.image.imageName eq image.imageName?'img-active':'font-light'}">
                                    <div>
                                        <h:commandLink title="#{image.tooltip}">
                                            <h:graphicImage value="#{image.thumbnailUrl}" title="#{image.tooltip}" styleClass="#{image.imageName == AktuelleSchritteForm.myPlugin.image.imageName ? 'img-active' : ''}" />
                                            <x:updateActionListener value="#{image.order -1}" property="#{AktuelleSchritteForm.myPlugin.imageIndex}" />
                                            <f:ajax execute="@form" render="@form :bigimage"/>
                                        </h:commandLink>
                                    </div>
                                    <div class="goobi-thumbnail-caption">
                                        <h:outputText value="#{image.imageNameShort}"></h:outputText>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                        <!-- // Thumbnail list -->

                        <div class="row">
                            <ui:include src="ImageQAPlugin_include_thumbnavigation.xhtml" />
                        </div>

                    </h:panelGroup>
                    <h:panelGroup layout="block" rendered="#{AktuelleSchritteForm.myPlugin.sizeOfImageList gt 0}" styleClass="col-sm-5">

                        <h:panelGroup id="bigimage">

                            <div class="row pull-center">
                                <ui:include src="ImageQAPlugin_include_imagenavigation.xhtml" />
                                <ui:include src="ImageQAPlugin_include_imageControls.xhtml" />
                            </div>

                            <!-- big image -->
                            <div class="row margin-top-most margin-bottom-most">
                                <h:panelGroup styleClass="div-image" layout="block">
<!--                                     <h:graphicImage class="margin-bottom-regular" value="#{AktuelleSchritteForm.myPlugin.bild}" rendered="#{AktuelleSchritteForm.myPlugin.image != null}" width="100%" /> -->
                                   	<div id="mainImage" class="margin-bottom-regular" rendered="#{AktuelleSchritteForm.myPlugin.image != null}"/>
                                    <div class="big-image-caption margin-top-regular font-light">
                                        <h:outputText value="#{AktuelleSchritteForm.myPlugin.image.imageName}" />
                                    </div>
                                    <script type="text/javascript">
                                    $('#mainImage').height($('#mainImage').width() * #{AktuelleSchritteForm.myPlugin.imageHeight}/#{AktuelleSchritteForm.myPlugin.imageWidth});
                                    var imageViewConfig = {
                            			    global: {
                            			        divId : 'mainImage',
                            			        zoomSlider : 'zoomSlider',
                            			        maxZoomLevel: 10
                            			    },
                            			    image: {
                            			        mimeType: "image/jpg",
                            			        imageLevels: #{AktuelleSchritteForm.myPlugin.image.imageLevels},
                            			        imageOriginalWidth: #{AktuelleSchritteForm.myPlugin.imageWidth},
                            			        imageOriginalHeight: #{AktuelleSchritteForm.myPlugin.imageHeight},
                            			        imageViewWidth: $('#mainImage').width(),
                            			        imageViewHeight: $('#mainImage').height(),
                            			        tileUrl: null
                            			    }
                            			}; 
                                    viewImage.close();
                                    viewImage.init(imageViewConfig);
                                    </script>
                                </h:panelGroup>
                            </div>
                            <!-- // big image -->

                            <div class="row">
                                <ui:include src="ImageQAPlugin_include_imagenavigation.xhtml" />
                            </div>

                        </h:panelGroup>
                    </h:panelGroup>

                    <h:panelGroup layout="block" rendered="#{AktuelleSchritteForm.myPlugin.sizeOfImageList == 0}" styleClass="col-sm-12">
                        <h:outputText value="#{msgs.noImagesFound}" />
                    </h:panelGroup>
                </div>

                <div class="form-actions">

                    <!-- Save -->
                    <h:commandLink styleClass="btn btn-lightgrey pull-right font-size-s" id="absenden" action="#{AktuelleSchritteForm.myPlugin.cancel}">
                        <i class="fa fa-check margin-right-5"></i>
                        <h:outputText value="#{msgs.pluginLeave}" />
                    </h:commandLink>
                   
                </div>

            </div>

        </h:form>

        <script type="text/javascript">
$( document ).ready(function() {
	var height = #{AktuelleSchritteForm.myPlugin.thumbnailSize};
	$('.goobi-thumbnail').css('max-width', height + 2 + 'px');
	$('.goobi-thumbnail').css('max-height', height + 18 + 'px');

	$('.goobi-thumbnail .goobi-thumbnail-image').css('max-height', height + 2 + 'px');

});
</script>

    </ui:define>

</ui:composition>